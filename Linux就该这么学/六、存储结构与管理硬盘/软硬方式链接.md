# 软硬方式链接
在引领大家学习完本章所有的磁盘管理知识之后，刘遄老师终于可以放心大胆地讲解Linux 系统中的“快捷方式”了。在 Windows 系统中，快捷方式就是指向原始文件的一个链接文件，能够让用户从不同的位置访问原始的文件；原文件一旦被删除或剪切到其他地方， 会导致链接文件失效。但是，这个看似简单的东西在 Linux 系统中可不太一样。

Linux 系统中存在软链接和硬链接两种不同的类型。

软链接（soft link）：也叫符号链接（symbolic link），仅仅包含所链接文件的名称和路径，很像一个记录地址的标签。当原始文件被删除或移动后，新的链接文件也会随之失效，不能被访问。可以针对文件、目录设置软链接，而且跨文件系统进行链接也不是问题。从这一点来看，它与 Windows 系统的“快捷方式”具有一样的性质。用户访问软链接的效果如图 6-16 所示。

![](img/2025-12-08-14-41-54.png)
软链接原理示意图

硬链接（hard link）：可以将它理解为一个“指向原始文件 block 的指针”，系统会创建出一个与原来一模一样的 inode 信息块。所以，硬链接文件与原始文件其实是完全一样的，只是名字不同。每添加一个硬链接，该文件的 inode 个数就会增加 1； 而且只有当该文件的 inode 个数为 0 时，才算彻底将它删除。换言之，由于硬链接实际上是指向原文件 block 的指针，因此即便原始文件被删除，依然能够通过硬链接文件来访问。需要注意的是，由于技术的局限性，不能跨分区对目录文件进行硬链接。用户访问硬链接的效果如图 6-17 所示。

![](img/2025-12-08-14-42-23.png)
硬链接原理示意图

Tips ：
大家翻开手头这本书的目录页，看一下目录标题和对应的页码就应该能够理解了。 链接文件就是指向实际内容所在位置的一个标签，通过这个标签，可以找到对应的数据。

ln 命令用于创建文件的软硬链接，英文全称为 link，语法格式为“ln [参数] 原始文件名 链接文件名”。

ln 命令的可用参数以及作用如表 6-7 所示。在使用 ln 命令时，是否添加-s 参数，将创建出性质不同的两种“快捷方式”。因此如果没有扎实的理论知识和实践经验做铺垫，尽管能够成功完成实验，但永远不会明白为什么会成功。

**ln 命令的可用参数以及作用**
参数	作用
-s	创建“符号链接”（如果不带-s 参数，则默认创建硬链接）
-f	强制创建文件或目录的链接
-i	覆盖前先询问
-v	显示创建链接的过程

为了更好地理解软链接、硬链接的不同性质，我们先创建出一个文件，为其创建一个软链接：
```shell
root@linuxprobe:~# echo "Welcome to linuxprobe.com" > old.txt
root@linuxprobe:~# ln -s old.txt new.txt
root@linuxprobe:~# cat old.txt 
Welcome to linuxprobe.com
root@linuxprobe:~# cat new.txt 
Welcome to linuxprobe.com
root@linuxprobe:~# ls -l old.txt 
-rw-r--r--. 1 root root 26 Mar 16 23:16 old.txt
```
原始文件名为 old，新的软链接文件名为 new。删掉原始文件后，软链接文件立刻就无法读取了：
```shell
root@linuxprobe:~# rm -f old.txt 
root@linuxprobe:~# cat new.txt 
cat: new.txt: No such file or directory
root@linuxprobe:~# rm -f new.txt
```
接下来针对原始文件 old 创建一个硬链接，即相当于针对原始文件的磁盘存储位置创建了一个指针。这样一来，新创建的这个硬链接就不再依赖于原始文件的名称等信息，也不会因为原始文件的删除而导致无法读取了。同时可以看到创建出硬链接文件后，原始文件的磁盘链接数量也应声增加到了 2。
```shell
root@linuxprobe:~# echo "Welcome to linuxprobe.com" > old.txt
root@linuxprobe:~# ln old.txt new.txt
root@linuxprobe:~# cat old.txt 
Welcome to linuxprobe.com
root@linuxprobe:~# cat new.txt 
Welcome to linuxprobe.com
root@linuxprobe:~# ls -l old.txt 
-rw-r--r--. 2 root root 26 Mar 16 23:18 old.txt
```
这是一个非常有意思的现象。创建的硬链接文件竟然会让文件属性第二列的数字变成了2，这个数字表示的是文件的 inode 信息块的数量。相信同学们已经非常肯定地知道，即便删除了原始文件，新的文件也会一如既往地可以读取，因为只有当文件 inode 数量被“清零” 后，才真正代表这个文件被删除了。
```shell
root@linuxprobe:~# rm -f old.txt 
root@linuxprobe:~# cat new.txt 
Welcome to linuxprobe.com
```
至此，我们就完成了磁盘基础管理知识的学习，但为了更好地满足实际生产工作的需要， 还需要学习一些更高级的磁盘技术，例如将多块磁盘合并成磁盘阵列组的 RAID，以及实现动态分区容量调整的 LVM，赶快翻开第 7 章吧。