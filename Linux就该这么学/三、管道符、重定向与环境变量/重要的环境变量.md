# 重要的环境变量
变量是计算机系统用于保存可变值的数据类型。在 Linux 系统中，变量名称一般都是大写的，命令则都是小写的，这是一种约定俗成的规范。Linux 系统中的环境变量用于定义系统运行环境的一些参数，比如每个用户不同的家目录、邮件存放位置等。可以直接通过变量名称来提取到对应的变量值。

细心的读者应该已经发现，本节和上一节的标题名都分别加了形容词—重要的、常用的。原因其实不言而喻，要想让 Linux 系统能够正常运行并且为用户提供服务，则需要数百个环境变量来协同工作，我们没有必要逐一介绍、学习每一个变量，而是应该在有限的精力中学习最重要的内容。

为了更好地理解变量的作用，给大家举个例子。前文中曾经讲到，在 Linux 系统中一切都是文件，Linux 命令也不例外。那么，在用户执行一条命令之后，Linux 系统中到底发生了什么事情呢？简单来说，命令在 Linux 中的执行分为 4 个步骤。
第 1 步：判断用户是以绝对路径还是相对路径的方式输入命令（如/bin/ls），如果是绝对路径则直接执行，否则进入第 2 步继续判断。

第 2 步：Linux 系统检查用户输入的命令是否为“别名命令”，即用一个自定义的命令名称来替换原本的命令名称。之前在使用 rm 命令删除文件时，Linux 系统都会要求用户确认是否执行删除操作，其实这就是 Linux 系统为了防止用户误删除文件而特意设置的 rm 别名命令—rm -i。
```shell
root@linuxprobe:~# ls
anaconda-ks.cfg  Documents  Music     Public     Videos
Desktop          Downloads  Pictures  Templates
root@linuxprobe:~# rm -r Music
rm: remove directory 'Music'? y
```
可以用 alias 命令创建一个属于自己的命令别名，语法格式为“alias 别名=命令”。若要取消一个命令别名，则使用 unalias 命令，语法格式为“unalias 别名”。

下面将当前 rm 命令被设置的别名取消掉，再删除文件试试：
```shell
root@linuxprobe:~# unalias rm
root@linuxprobe:~# rm -r Videos
root@linuxprobe:~#
```
第 3 步：Bash 解释器判断用户输入的是内部命令还是外部命令。内部命令是解释器内部的命令，会被直接执行；而用户在绝大部分时间输入的是外部命令，这些命令交由第 4 步继续处理。可以使用“type 命令名称”来判断用户输入的命令是内部命令还是外部命令。
```shell
root@linuxprobe:~# type echo
echo is a shell builtin
root@linuxprobe:~# type uptime
uptime is /usr/bin/uptime
```
第 4 步：系统在多个路径中查找用户输入的命令文件，而定义这些路径的变量叫作 PATH， 可以简单地把它理解成是“解释器的小助手”，其作用是告诉 Bash 解释器待执行的命令可能存放的位置，然后 Bash 解释器就会乖乖地在这些位置中逐个查找。PATH 是由多个路径值组成的变量，每个路径值之间用冒号间隔，对这些路径的增加和删除操作将影响到 Bash 解释器对 Linux 命令的查找。
```shell
root@linuxprobe:~# echo $PATH
/root/.local/bin:/root/bin:/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin
root@linuxprobe:~# PATH=$PATH:/root/bin
root@linuxprobe:~# echo $PATH
/root/.local/bin:/root/bin:/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/root/bin
```
这里有个比较经典的问题：“为什么不能将当前目录（.）添加到 PATH 中呢？”原因是，尽管允许将当前目录（.）添加到 PATH 变量中，从而在某些情况下让用户免去输入命令所在路径的麻烦。但是，如果黑客在比较常用的公共目录/tmp 中存放了一个与 ls 或 cd 命令同名的木马文件，而用户又恰巧在公共目录中执行了这些命令，那么就极有可能中招，安全隐患大增。

因此，作为一名态度谨慎且经验丰富的运维人员，接手一台 Linux 系统后一定要在执行命令前先检查 PATH 变量中是否有可疑的目录。另外，读者是否也从前面的 PATH 变量示例中感觉到环境变量特别有用呢？我们可以使用 env 命令查看 Linux 系统中所有的环境变量， 而刘遄老师为你精挑细选出了最重要的 10 个环境变量，如表 3-4 所示。

重要的环境变量 

|   变量名称   |               作用               |
| :----------: | :------------------------------: |
|     HOME     |     用户的主目录（即家目录）     |
|    SHELL     |   用户在使用的Shell解释器名称    |
|   HISTSIZE   |      输出的历史命令记录条数      |
| HISTFILESIZE |      保存的历史命令记录条数      |
|     MAIL     |           邮件保存路径           |
|     LANG     |        系统语言、语系名称        |
|    RANDOM    |         生成一个随机数字         |
|     PS1      |        Bash解释器的提示符        |
|     PATH     | 定义解释器搜索用户执行命令的路径 |
|    EDITOR    |       用户默认的文本编译器       |
Linux 作为一个多用户、多任务的操作系统，能够为每个用户提供独立的、合适的工作运行环境。因此，一个相同的变量会因为用户身份的不同而具有不同的值。例如，使用下述命令查看 HOME 变量在不同的用户身份下都有哪些值（su 是用于切换用户身份的命令，将在第 5 章跟大家见面）：
```shell
root@linuxprobe:~# echo $HOME
/root
root@linuxprobe:~# su - linuxprobe
linuxprobe@linuxprobe:~$ echo $HOME
/home/linuxprobe
linuxprobe@linuxprobe:~$ exit
```
其实变量是由固定的变量名与用户或系统设置的变量值两部分组成的，我们完全可以自行创建变量来满足工作需求。例如，设置一个名称为 WORKDIR 的变量，以方便用户轻松地进入一个层次较深的目录：
```shell
root@linuxprobe:~# mkdir /home/workdir
root@linuxprobe:~# WORKDIR=/home/workdir
root@linuxprobe:~# cd $WORKDIR 
root@linuxprobe:/home/workdir# pwd
/home/workdir
root@linuxprobe:/home/workdir# cd ~
```
但是，这样的变量不具有全局性，作用范围也有限，默认情况下不能被其他用户使用：
```shell
root@linuxprobe:~# su linuxprobe
linuxprobe@linuxprobe:/root$ cd $WORKDIR
linuxprobe@linuxprobe:~$ echo $WORKDIR

linuxprobe@linuxprobe:~$ exit
```
如果工作需要，可以使用 export 命令将其提升为全局变量，这样在该 Bash 进程下，其他用户也就可以使用它了：
```shell
root@linuxprobe:~# export WORKDIR
root@linuxprobe:~# su linuxprobe
linuxprobe@linuxprobe:/root$ cd $WORKDIR
linuxprobe@linuxprobe:/home/workdir$ pwd
/home/workdir
linuxprobe@linuxprobe:/home/workdir$ exit
```
后续要是不使用这个变量了，则可以用 unset 命令将其从当前Shell 中移除：
```shell
root@linuxprobe:~# unset WORKDIR
root@linuxprobe:~#
```
Tips ：
直接在终端设置的变量能够立即生效，但在重启服务器后会失效，因此我们需要将变量和变量值写入.bashrc 或者.bash_profile 文件中，以确保能永久使用它们。什么？ 不知道该怎么编辑文件？快来看第 4 章吧。